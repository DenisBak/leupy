"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[90507],{10924:function(e,t,a){a.d(t,{I:function(){return T}}),a(21703);var o=a(30091),n=a(91966),s=a.n(n),r=a(44908),i=a.n(r),d=a(98116),c=(a(26699),a(48366)),l=a(31409),u=a(65740),f=a(30040),p=a(78364),m=a(82249),y=a(63246),g=a(25628);const h={guestiaId:null,premiumStateId:null},E=(0,d.createEvent)({sid:"-cg0gyi"}),b=(0,d.attach)({and:{source:p.f.internals.$heliosFlags,effect:e=>{return(0,f.uF)({trackerId:"aviasales_helios",expGroups:{expGroups:(t=e,Object.entries(t).map((([e,t])=>`${e}-${t?.variantKey??"null"}`)))},settings:{debug:!m.O.isProduction}});var t}},or:{sid:"smyu8m"}}),w=(0,d.createStore)(!1,{sid:"g67ojg"}).on(b.done,(()=>!0)),v=(0,d.createEffect)((()=>new Promise((e=>{setTimeout((()=>{e()}),2e3)}))),{sid:"urlddt"}),_=(0,d.createEvent)({sid:"5qhad1"}),z=(0,d.createStore)(null,{sid:"-vmyhzc"}).on(_,((e,t)=>({...e??{},...t}))),A=(0,d.createStore)(!1,{sid:"cylji7"}).on(z,((e,t)=>!!t&&Object.keys(t).includes("guestiaId")&&Object.keys(t).includes("premiumStateId"))),F=(0,g.IG)(!1,(()=>{let e={};try{const t=window.localStorage.getItem("_debugSettings");e=JSON.parse(t??"")}catch{}return Boolean(e?.debugMetrics)})),S=(0,d.attach)({and:{effect:({commonFields:e},{data:t,settings:a,payload:o})=>{const n={data:{...h,...e,...t,is_selene:!0},payload:o};return a&&(n.settings={...a,...n.settings}),F&&console.log("EVENT:",`${t.service} ${t.category} ${t.label} ${t.action}`,{...o}),(0,f._P)(n.data,n.payload,n.settings)},source:{commonFields:z}},or:{sid:"nhoc88"}}),k=(0,d.createEvent)({sid:"z2bi8z"}),O=(0,d.createEvent)({sid:"-zbphxf"}),j=(0,d.createEffect)((e=>Promise.all(e.map(S))),{sid:"-c8632t"}),D=(0,d.createStore)([],{and:{serialize:"ignore"},sid:"-39km6e"}).on(O,((e,t)=>i()([...e,t]))).on(j.done,((e,{params:t})=>s()(e,t))),$=(0,d.createStore)(!1,{sid:"lhensr"}).on(v.done,(()=>!0)),I=(0,d.withFactory)({sid:"-8qxres",fn:()=>(0,c.G)({predicate:!0,stores:[A,$]})}),P=(0,d.withFactory)({sid:"2aoown",fn:()=>(0,l.y)({predicate:!0,stores:[w,I]})}),x=(0,d.createEvent)({sid:"-iun9su"});(0,d.withFactory)({sid:"-nhzz74",fn:()=>(0,u.s)({source:k,if:P,then:S,else:O})}),(0,d.sample)({and:[{source:P,filter:e=>e,target:x}],or:{sid:"-ne5f1l"}}),(0,d.sample)({and:[{clock:x,source:D,filter:e=>e.length>0,target:j}],or:{sid:"-mzaz0u"}}),(0,d.sample)({and:[{clock:E,filter:y.y.outputs.$isClient,target:[b,v]}],or:{sid:"4zgbfd"}});const L={inputs:{forwardToAnalytics:function({from:e,data:t,payload:a}){(0,d.sample)({and:[{clock:e,fn:e=>({data:t,payload:{...a,...e}}),target:k}],or:{sid:"-m2bbdg"}})},commonField:function(e){const{source:t,filter:a=(()=>!0),name:o}=e;(0,d.sample)({and:[{source:t,filter:a,fn:e=>({[o]:e}),target:_}],or:{sid:"4iep2w"}})},createReporter:function({data:e,payload:t}={}){return a=>{const{data:o,payload:n,clock:s}=a;if(!e&&!o)throw new Error("Нет значения у `data`");if(!t&&!n)throw new Error("Не хватает `payload`");const r="function"==typeof o,i="function"==typeof n,c=(0,d.combine)({and:[{customData:r?o:(0,d.combine)({and:[o??{}],or:{sid:"z5t8d5"}}),customPayload:i?n:(0,d.combine)({and:[n??{}],or:{sid:"sljjx0"}}),data:(0,d.combine)({and:[e??{}],or:{sid:"-w3eynl"}}),payload:(0,d.combine)({and:[t??{}],or:{sid:"e21cpz"}})}],or:{sid:"-r04l85"}});(0,d.sample)({and:[{clock:s,source:c,fn:(e,t)=>{let a,o;return"function"==typeof e.customData?a=e.customData(t,{data:e.data,payload:e.payload}):(a={...e.data},Object.entries(e.customData).forEach((([e,o])=>{a[e]="function"==typeof o?o(t):o}))),"function"==typeof e.customPayload?o=e.customPayload(t,{data:e.data,payload:e.payload}):(o={...e.payload},Object.entries(e.customPayload).forEach((([e,a])=>{o[e]="function"==typeof a?a(t):a}))),{data:a,payload:o}},target:k}],or:{sid:"-8acw40"}})}},sendEvent:k},internals:{initAnalyticsFx:b,$inited:w,$allCommonFieldsAdded:A,sendAnalyticsEventFx:S,addCommonFieldsToEvents:_}},T=(0,o.Yn)({lifecycle:{start:E},importMetaUrl:"file:///home/jenkins/agent/workspace/selene/client/src/platform/services/analytics/index.ts",api:L,attachTestApi:()=>{throw new Error("Test API is not available in production")}})}}]);
//# sourceMappingURL=https://private-static.prod.k8s.int.avs.io/selene-source-maps/platform-2c718f59088544dcc5f1bf69a63f76f8dfddb990.ac650f3456896da05731.min.js.map