(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[16436],{55479:function(e,t,r){"use strict";r.d(t,{D:function(){return R}});var i=r(30091),o=r(98116),s=r(68346),a=r(39777),n=r(35529);const l=(0,n.Record)({status:(0,n.Literal)("success"),success:(0,n.Record)({order_id:n.String})}),c=(0,n.Record)({status:(0,n.Union)((0,n.Literal)("payment_error"),(0,n.Literal)("unknown")),error:(0,n.Record)({message:n.String,order_id:(0,n.Optional)(n.String)})}),d=(0,n.Record)({status:(0,n.Literal)("subscription_active"),active:(0,n.Record)({order_id:n.String})}),u=(0,n.Union)(l,c,d);var p=r(76588),m=r(80472),y=r(62423),h=r(6560),g=r(35255),k=r(64783);const{$headers:b,$commonParams:f}=h.s.outputs,x=(0,o.withFactory)({sid:"o1s74k",fn:()=>(0,p.tW)({name:"renew_subscription_mutation",request:{credentials:"include",method:"POST",url:(0,g.l)({endpoint:y.vG.Renew}),query:{source:f,fn:(e,t)=>t},headers:{source:b,fn:(e,t)=>t}},response:{contract:(0,m.v)(u)}})});(0,o.withFactory)({sid:"mgtmo3",fn:()=>(0,p.XD)(x,k.z)});const w=x.$pending,P=(0,o.createEvent)({sid:"q92zaq"}),{requestSuccessfullyCompleted:v,requestFailed:E,contractValidationFailed:$}=(0,a.E)(x);(0,o.sample)({and:[{clock:P,target:x.start}],or:{sid:"6yhao3"}});const{receivedAlreadyActive:C,receivedError:S,receivedSuccess:M}=(0,o.split)({and:[v,{receivedAlreadyActive:d.guard,receivedError:c.guard,receivedSuccess:l.guard}],or:{sid:"h9yemg"}}),_=M.map((e=>({orderId:e.success.order_id}))),B=C.map((e=>({orderId:e.active.order_id}))),D=S.map((e=>({orderId:e.error.order_id,message:e.error.message})));(0,o.sample)({and:[{clock:$,fn:e=>({name:"Renew scheme dto validation error",errorMessage:e.validationErrors,errorType:e.errorType,explanation:e.explanation,data:e.response}),target:s.R.inputs.logContractError}],or:{sid:"8dm5uo"}});const A={inputs:{requested:P},outputs:{$isProcessing:w,subscriptionSuccessfulyRenewed:_,subscriptionAlreadyActivated:B,subscriptionRenewPaymentFailed:D,requestFailed:E},internals:{stubs:{successRenewDtoStub:{status:"success",success:{order_id:"1"}},successRenewDataStub:{orderId:"1"},renewPaymentFailedDtoStub:{status:"payment_error",error:{message:"error_message",order_id:"1"}},renewPaymentFailedDataStub:{message:"error_message",orderId:"1"}},renewSubscriptioMutation:x}},j={...A.inputs},F={...A.outputs},T={mutation:A.internals.renewSubscriptioMutation,stubs:{...A.internals.stubs}},R=(0,i.G6)({importMetaUrl:"file:///home/jenkins/agent/workspace/selene/client/src/product/premium/services/api_renew/index.ts",api:{outputs:F,inputs:j,internals:T}})},2150:function(e,t,r){"use strict";r.d(t,{F:function(){return ye}}),r(26699);var i=r(4190),o=r(97608),s=r(47166),a=r.n(s),n=r(99491),l=r(6328),c=r(62423),d=r(32146),u=r(44074),p=r(27796),m=r(59566),y=r(30893),h=r(30839),g=r(48293),k=r(20256),b=r(1688),f=r(89421),x=r(33380),w=r(85893);const P=a().bind({content:"s__Pgn9PCSQzcALIbgkVezk","background-container":"s__JsvcwE2MWr0gkHylMurC",centered:"s__rNUXViLRRS1vUWUQrPKl"}),v=({children:e,centered:t})=>(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:P("content",{centered:t}),children:e}),(0,w.jsx)("div",{className:P("background-container"),children:(0,w.jsx)(x.E,{theme:"default"})})]});var E=r(98116),$=r(47047),C=r(15863);const{turnOff:S,turnOn:M,$enabled:_}=(0,E.withFactory)({sid:"hpkp3p",fn:()=>(0,$.d)(C.qs,!1)}),B={hideModal:S,showModal:M,$isModalVisible:_};var D=r(67294),A=r(28225),j=r(38387),F=r(65740),T=r(72675),R=r(82097),V=r(66981),L=r.n(V),q=r(3409),N=r(5525),U=r(24991),O=r(30828),I=r(68621),z=r(54428),G=r(96864),Q=r(64131);const W={paymentFailed:(0,E.sample)({and:[{clock:[N.g.outputs.payFailed,O.l.outputs.applePaySessionFailures,Q.F.outputs.paymentFailed,p.x.outputs.threeDsFailed],filter:B.$isModalVisible}],or:{sid:"-690ilv"}}),threeDsStarted:(0,E.sample)({and:[{clock:p.x.inputs.threeDsStarted,filter:B.$isModalVisible}],or:{sid:"5x7sxq"}}),paymentCancelledDueToAlreadyActive:(0,E.sample)({and:[{clock:[N.g.outputs.completedWithAlreadyActive,O.l.outputs.completedWithAlreadyActive,Q.F.outputs.paymentRejectedAlreadyActive],filter:B.$isModalVisible}],or:{sid:"-jv5ti7"}}),paymentFailedDueToInvalidPromocode:(0,E.sample)({and:[{clock:[N.g.outputs.completedWithInvalidPromocode,O.l.outputs.completedWithInvalidPromocode,Q.F.outputs.paymentRejectedInvalidPromocode],filter:B.$isModalVisible}],or:{sid:"m4hhei"}}),purchaseCompletedSuccessfully:(0,E.sample)({and:[{clock:[N.g.outputs.payCompletedSuccessfully,O.l.outputs.completedSuccessfully,Q.F.outputs.paymentCompleted,p.x.outputs.paymentCompleted],filter:B.$isModalVisible}],or:{sid:"-lawqga"}})},H=(0,E.sample)({and:[{clock:q.h.outputs.received,filter:B.$isModalVisible}],or:{sid:"-y0t4c6"}}),K=(0,E.createEvent)({sid:"mlra4r"}),X=(0,E.createEvent)({sid:"mz8mai"});(0,E.withFactory)({sid:"-ktoz1m",fn:()=>(0,F.s)({source:H,if:e=>e.length>0,then:d.V.inputs.inModalPurchase.goToPurchaseForm,else:d.V.inputs.inModalPurchase.goToGeneralError})}),(0,E.sample)({and:[{clock:q.h.outputs.requestFailed,filter:B.$isModalVisible,target:d.V.inputs.inModalPurchase.goToGeneralError}],or:{sid:"-k0jvlh"}}),(0,E.sample)({and:[{clock:z.O.outputs.loggedIn,filter:(0,E.withFactory)({sid:"-3qoasa",fn:()=>(0,T.x)(B.$isModalVisible,I.b.outputs.$isAnyPremiumActive,(0,E.withFactory)({sid:"-wv9dxo",fn:()=>(0,R.f)(d.V.outputs.inModalPurchase.$screen,c.D$.PurchaseForm)}))}),target:d.V.inputs.inModalPurchase.goToAlreadyActiveAuth}],or:{sid:"-jiyglx"}}),(0,E.sample)({and:[{clock:[K,p.x.inputs.paymentCardChanged],filter:(0,E.withFactory)({sid:"pm49ns",fn:()=>(0,T.x)(B.$isModalVisible,(0,E.withFactory)({sid:"-vxpxqn",fn:()=>(0,R.f)(d.V.outputs.inModalPurchase.$screen,c.D$.ThreeDs)}))}),target:[N.g.inputs.reset,d.V.inputs.inModalPurchase.goToPurchaseForm]}],or:{sid:"-ikv7tj"}}),(0,E.split)({and:[{clock:X,source:d.V.outputs.inModalPurchase.$screen,match:{loadingScreen:L()(c.D$.Loading),errorScreen:L()(c.D$.GeneralError),purchaseFormScreen:L()(c.D$.PurchaseForm),threeDsScreen:L()(c.D$.ThreeDs),alreadyActiveAuthScreen:L()(c.D$.AlreadyActiveAuth),alreadyActivePaymentScreen:L()(c.D$.AlreadyActivePayment)},cases:{loadingScreen:[B.hideModal,U.C.inputs.reset],errorScreen:[B.hideModal,d.V.inputs.inModalPurchase.goToLoading,U.C.inputs.reset],purchaseFormScreen:B.hideModal,threeDsScreen:B.hideModal,alreadyActiveAuthScreen:B.hideModal,alreadyActivePaymentScreen:B.hideModal}}],or:{sid:"-hzz19t"}}),(0,E.sample)({and:[{clock:W.threeDsStarted,target:d.V.inputs.inModalPurchase.goToThreeDs}],or:{sid:"w8rhns"}}),(0,E.sample)({and:[{clock:W.paymentFailed,target:[g.a.inputs.showCommonPayErrorModal,d.V.inputs.inModalPurchase.goToPurchaseForm,N.g.inputs.reset,O.l.inputs.reset]}],or:{sid:"wpt41z"}}),(0,E.sample)({and:[{clock:W.paymentCancelledDueToAlreadyActive,target:d.V.inputs.inModalPurchase.goToAlreadyActivePayment}],or:{sid:"xl5dvk"}}),(0,E.sample)({and:[{clock:W.paymentFailedDueToInvalidPromocode,target:d.V.inputs.inModalPurchase.goToPromocodeActivationError}],or:{sid:"y1n7oe"}}),(0,E.sample)({and:[{clock:[h.o.inputs.continuePaymentWithoutPromocode,h.o.inputs.cancelPayment],filter:B.$isModalVisible,target:d.V.inputs.inModalPurchase.goToPurchaseForm}],or:{sid:"y4e6n7"}}),(0,E.sample)({and:[{clock:W.purchaseCompletedSuccessfully,target:[B.hideModal,G.W.inputs.fetchUserDataFx]}],or:{sid:"ykw0g1"}});const J={closeButtonClicked:X,backButtonClicked:K};var Y=r(9071),Z=r(5393),ee=r(78620);const te=({onClick:e,mode:t})=>"short"===t?(0,w.jsx)(Y.w.Action,{backAction:!0,onClick:e,icon:(0,w.jsx)(ee.I,{})}):(0,w.jsx)(Y.w.Back,{onClick:e}),re=({title:e,onBackClick:t,onCloseClick:r,shortBackButton:i=!1})=>(0,w.jsxs)(Y.w,{transparent:!0,shadow:!1,children:[(0,w.jsx)(Y.w.LeftAccessory,{children:t&&(0,w.jsx)(te,{onClick:t,mode:i?"short":"regular"})}),(0,w.jsx)(Y.w.Title,{title:e}),(0,w.jsx)(Y.w.RightAccessory,{children:r&&(0,w.jsx)(Z.P,{onClick:r})})]}),ie=(0,D.memo)(re),oe=a().bind({navbar:"s__TzceZlaiSTJ5KioBehVG"}),se=()=>{const{t:e}=(0,A.useTranslation)("service_in_modal_purchase"),t=(0,i.useUnit)(j.l.outputs.$isMobile),{backButtonClicked:r,closeButtonClicked:o}=(0,i.useUnit)(J),s=(0,i.useUnit)(d.V.outputs.inModalPurchase.$screen),a=(0,D.useMemo)((()=>(0,u.Y7)(s,{[c.D$.Loading]:{onCloseClick:o},[c.D$.PurchaseForm]:{title:e("screenTitle.payment"),onCloseClick:o},[c.D$.PurchaseSuccess]:{onCloseClick:o},[c.D$.GeneralError]:{onCloseClick:o},[c.D$.ThreeDs]:{title:e("screenTitle.threeDs"),onBackClick:r,onCloseClick:o,shortBackButton:t},[c.D$.AlreadyActiveAuth]:{title:e("screenTitle.auth"),onCloseClick:o},[c.D$.AlreadyActivePayment]:{title:e("screenTitle.payment"),onCloseClick:o},[c.D$.PromocodeActivationError]:{title:e("screenTitle.payment"),onBackClick:r,onCloseClick:o}},{})),[e,s,t,o,r]);return(0,w.jsx)("div",{className:oe("navbar"),children:(0,w.jsx)(ie,{...a})})},{ThreeDsContainer:ae}=p.x.containers,{ExpiredPromocodeError:ne}=m.w.outputs,{PurchaseFormContainer:le}=h.o.containers,{CommonPayErrorPopupContainer:ce}=g.a.containers,de=a().bind({root:"s__b9OQbaCnEmbpGccQDQl8",error:"s__FQk2w4OXuWsgFSAh6RgH"}),ue=[c.D$.Loading,c.D$.GeneralError,c.D$.AlreadyActiveAuth,c.D$.AlreadyActivePayment,c.D$.PromocodeActivationError],pe=(0,E.createEvent)({sid:"vh8rfh"}),me=(0,E.createEvent)({sid:"-lp76rv"});(0,E.sample)({and:[{clock:pe,target:B.showModal}],or:{sid:"6kt1i1"}}),(0,E.withFactory)({sid:"71unw8",fn:()=>(0,F.s)({source:B.showModal,if:I.b.outputs.$isAnyPremiumActive,then:d.V.inputs.inModalPurchase.goToAlreadyActiveAuth,else:me})}),(0,E.withFactory)({sid:"7jzvh5",fn:()=>(0,F.s)({source:me,if:U.C.outputs.$isOffersEmpty,then:U.C.inputs.launch,else:d.V.inputs.inModalPurchase.goToPurchaseForm})});const ye={containers:{InModalPurchaseContainer:()=>{const e=(0,i.useUnit)(B.$isModalVisible),t=(0,i.useUnit)(B.hideModal),r=(0,i.useUnit)(f.H.outputs.$isNight),s=(0,i.useUnit)(d.V.outputs.inModalPurchase.$screen),a=(0,i.useUnit)(y.G.outputs.$originalPrice),p=(0,i.useUnit)(y.G.outputs.$currency),m=(0,i.useUnit)(h.o.inputs.continuePaymentWithoutPromocode),g=(0,i.useUnit)(h.o.inputs.cancelPayment),x=r?n.IQ.OnBright:n.IQ.OnMoreGradient,P=(0,u.Z7)(d.V.outputs.inModalPurchase.$screen,{[c.D$.Loading]:(0,w.jsx)(l.$,{size:n.Ey.L,mod:x}),[c.D$.PurchaseForm]:(0,w.jsx)(le,{}),[c.D$.GeneralError]:(0,w.jsx)(k.M,{className:de("error")}),[c.D$.ThreeDs]:(0,w.jsx)(ae,{useLogo:!0,testId:"in-modal-purchase-3ds-iframe"}),[c.D$.AlreadyActiveAuth]:(0,w.jsx)(b.k,{mode:"auth"}),[c.D$.AlreadyActivePayment]:(0,w.jsx)(b.k,{mode:"pay"}),[c.D$.PromocodeActivationError]:(0,w.jsx)(ne,{originalPrice:a,currency:p,onCancel:g,onContinue:m})});return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(o.u,{visible:e,onClose:t,noHeader:!0,className:de("root"),children:[(0,w.jsx)(se,{}),(0,w.jsx)(v,{centered:ue.includes(s),children:P})]}),(0,w.jsx)(ce,{})]})}},inputs:{launch:pe},outputs:{$visible:B.$isModalVisible,purchaseCompletedSuccessfully:W.purchaseCompletedSuccessfully}}},23046:function(e,t,r){"use strict";r.d(t,{H:function(){return B}});var i=r(30091),o=r(98116),s=r(94547),a=r(62423),n=r(35529);const l=(0,n.Record)({premiumExpiredNoticeShown:(0,n.Optional)(n.Boolean),trialExpiredNoticeShown:(0,n.Optional)(n.Boolean),premiumExpiredSnackbarShown:(0,n.Optional)(n.Boolean)}),c=(0,n.Union)(l,n.Null),d=(0,o.createEvent)({sid:"-7ncgkt"}),u=(0,o.createEvent)({sid:"jrk85e"}),p=(0,o.createEvent)({sid:"87bsh9"}),m=(0,o.createEvent)({sid:"-7lhhqe"}),y=(0,o.createEvent)({sid:"-9kvcqe"}),h=(0,o.createEvent)({sid:"7kwei6"}),g=(0,s.Yu)("user_settings",{adapter:s.j$.json({contract:c})}),k=(0,o.createEffect)((()=>g.read()),{sid:"-w45i2"}),b=k.doneData,f=(0,o.createStore)(null,{sid:"-8lchva"}).on([b,u],((e,t)=>t)),x=(0,o.createEffect)((e=>{g.write(e)}),{sid:"-eybkox"});(0,o.sample)({and:[{clock:d,target:k}],or:{sid:"o9bd4i"}}),(0,o.sample)({and:[{clock:u,target:x}],or:{sid:"oc2c3b"}}),(0,o.sample)({and:[{clock:m,fn:e=>({name:a.rM.PremiumExpiredNoticeShown,value:e}),target:p}],or:{sid:"oqczip"}}),(0,o.sample)({and:[{clock:y,fn:e=>({name:a.rM.PremiumExpiredSnackbarShown,value:e}),target:p}],or:{sid:"p57fjg"}}),(0,o.sample)({and:[{clock:h,fn:e=>({name:a.rM.TrialExpiredNoticeShown,value:e}),target:p}],or:{sid:"pa5kvp"}}),(0,o.sample)({and:[{clock:p,source:f,fn:(e,{name:t,value:r})=>null===e?{[t]:r}:{...e,[t]:r},target:u}],or:{sid:"pp00wg"}});const w=f.map((e=>e?e.premiumExpiredNoticeShown??!1:null)),P=f.map((e=>e?e.premiumExpiredSnackbarShown??!1:null)),v={inputs:{readUserSettings:d,writeUserSettings:u,updatePremiumExpiredNoticeShown:m,updatePremiumExpiredSnackbarShown:y,updateTrialExpiredNoticeShown:h},outputs:{userSettingsReceived:b,$userSettings:f,$premiumExpiredNoticeShown:w,$premiumExpiredSnackbarShown:P},internals:{readUserSettingsFromLocalStorageFx:k,writeUserSettingsToLocalStorageFx:x}};var E=r(63246),$=r(68621);const{$isPremiumExpired:C,$isTrialExpired:S}=$.b.outputs,M=(0,o.createEvent)({sid:"6xben5"});(0,o.sample)({and:[{clock:M,filter:E.y.outputs.$isClient,target:v.inputs.readUserSettings}],or:{sid:"6mtxqx"}}),(0,o.sample)({and:[{clock:v.outputs.userSettingsReceived,source:C,filter:(e,t)=>{const r=t?.premiumExpiredNoticeShown;return!e&&(!0===r||void 0===r)},fn:(e,t)=>({...t,[a.rM.PremiumExpiredNoticeShown]:!1,[a.rM.PremiumExpiredSnackbarShown]:!1}),target:v.inputs.writeUserSettings}],or:{sid:"74fcqh"}}),(0,o.sample)({and:[{clock:v.outputs.userSettingsReceived,source:S,filter:(e,t)=>{const r=t?.trialExpiredNoticeShown;return!e&&(!0===r||void 0===r)},fn:()=>!1,target:v.inputs.updateTrialExpiredNoticeShown}],or:{sid:"83m6pl"}});const _={init:M},B=(0,i.G6)({importMetaUrl:"file:///home/jenkins/agent/workspace/selene/client/src/product/premium/services/local_user_settings/index.ts",lifecycle:{start:_.init},api:{inputs:{...v.inputs},outputs:{...v.outputs},internals:{...v.internals}}})},21279:function(e,t,r){"use strict";r.d(t,{k:function(){return Wt}});var i=r(98116),o=r(62423),s=r(2150),a=r(59051),n=r.n(a),l=r(38032),c=r(47047),d=r(15863),u=r(80911),p=r(20611),m=r(89421),y=r(97741),h=r(30091),g=r(68346),k=r(39777),b=r(35529),f=r(71049);const x=(0,b.Union)((0,b.Literal)("pay"),(0,b.Literal)("renew"),(0,b.Literal)("go_to_profile"),(0,b.Literal)("skip")),w=(0,b.Union)((0,b.Literal)("expired_profile"),(0,b.Literal)("expired_cashback"),(0,b.Literal)("expired_trap")),P=(0,b.Union)((0,b.Literal)("auto_renew_available"),(0,b.Literal)("auto_renew_unavailable"),(0,b.Literal)("auto_renew_disabled"),(0,b.Literal)("auto_renew_failed")),v=(0,b.Record)({error:b.String}),E=(0,b.Record)({label:b.String,action:(0,b.Record)({type:x})}),$=(0,b.Record)({title:b.String,subtitle:b.String,button:(0,b.Record)({label:b.String}),error:(0,b.Optional)((0,b.Record)({title:b.String,subtitle:b.String}))}),C=(0,b.Record)({type:w,view:(0,b.Record)({product_logo:f.Kh,title:b.String,subtitle:b.String,state:(0,b.Optional)(P),payment_method:(0,b.Optional)($),primary_button:E,secondary_button:(0,b.Optional)(E)})});var S=r(44074);const M=e=>n()(e)?null:{title:e.title,paymentMethodName:e.subtitle,button:e.button.label,errorTitle:e.error?.title,errorDescription:e.error?.subtitle},_=e=>n()(e)?null:{text:e.label,action:e.action.type};var B=r(79195);const D={view:{product_logo:B.Qu,title:"test title",subtitle:"test subtitle",state:"auto_renew_available",payment_method:{title:"payment_method test title",subtitle:"payment_method test subtitle",button:{label:"payment_method button label"},error:{title:"payment_method error title",subtitle:"payment_method error subtitle"}},primary_button:{label:"primary_button test label",action:{type:"renew"}},secondary_button:{label:"secondary_button test label",action:{type:"go_to_profile"}}}},A={view:{product_logo:B.Qu,title:"test title",subtitle:"test subtitle",primary_button:{label:"primary_button test label",action:{type:"renew"}}}},j={type:"expired_profile",...D},F={type:"expired_profile",productLogo:B.pA,title:"test title",subtitle:"test subtitle",state:"auto_renew_available",paymentMethod:{title:"payment_method test title",paymentMethodName:"payment_method test subtitle",button:"payment_method button label",errorTitle:"payment_method error title",errorDescription:"payment_method error subtitle"},primaryButton:{text:"primary_button test label",action:"renew"},secondaryButton:{text:"secondary_button test label",action:"go_to_profile"}},T={type:"expired_profile",...A},R={type:"expired_profile",productLogo:B.pA,title:"test title",subtitle:"test subtitle",state:null,primaryButton:{text:"primary_button test label",action:"renew"},secondaryButton:null,paymentMethod:null};var V=r(76588),L=r(80472),q=r(6560),N=r(35255),U=r(64783),O=r(51862);const{$headers:I,$commonParams:z}=q.s.outputs,G=(0,i.withFactory)({sid:"-r53npk",fn:()=>(0,V.s5)({name:"get_paywall_query",params:(0,i.withFactory)({sid:"-qufkwm",fn:()=>(0,V.t6)()}),request:{credentials:"include",method:"GET",url:(0,N.l)({endpoint:o.vG.Paywalls}),query:{source:z,fn:O.s},headers:{source:I,fn:(e,t)=>t}},response:{contract:(0,L.v)((0,b.Union)(C,v))}})});(0,i.withFactory)({sid:"b4ptei",fn:()=>(0,V.XD)(G,U.z)});const Q=G.$status,W=Q.map((e=>({isIdle:"initial"===e,isProcessing:"pending"===e,isSuccess:"done"===e,isFail:"fail"===e}))),H=(0,i.createEvent)({sid:"brus2k"}),{requestSuccessfullyCompleted:K,requestFailed:X,contractValidationFailed:J}=(0,k.E)(G);(0,i.sample)({and:[{clock:H,fn:e=>({type:e}),target:G.start}],or:{sid:"a14tnd"}});const{successfullyReceived:Y,receivedAlreadyActive:Z}=(0,i.split)({and:[K,{successfullyReceived:C.guard,receivedAlreadyActive:v.guard}],or:{sid:"-t0yrao"}}),ee=Y.map((e=>{const{view:t}=e;return{type:e.type,productLogo:(0,S.sf)(t.product_logo),title:t.title,subtitle:t.subtitle,state:t.state||null,paymentMethod:M(t.payment_method),primaryButton:_(t.primary_button),secondaryButton:_(t.secondary_button)}})),te=ee.map((e=>({title:e.title,description:e.subtitle}))),re=ee.map((e=>e.productLogo)),ie=ee.map((e=>e.type)),oe=ee.map((e=>e.primaryButton)),se=ee.map((e=>e.state)),ae=ee.map((e=>e.paymentMethod)),ne=ee.map((e=>e.secondaryButton)),le=(0,i.sample)({and:[{clock:ae,filter:Boolean}],or:{sid:"-e1uyr4"}}),ce=(0,i.sample)({and:[{clock:ne,filter:Boolean}],or:{sid:"-8l6fna"}}),de=(0,i.sample)({and:[{clock:se,filter:Boolean}],or:{sid:"-1w1xo8"}});(0,i.sample)({and:[{clock:J,fn:e=>({name:"PaywallDto scheme dto validation error",errorMessage:e.validationErrors,errorType:e.errorType,explanation:e.explanation,data:e.response}),target:g.R.inputs.logContractError}],or:{sid:"-hkkvwo"}});const ue={inputs:{requested:H},outputs:{$state:Q,$stateFlags:W,requestFailed:X,receivedMappedData:ee,logoReceived:re,paymentMethodReceived:le,primaryButtonReceived:oe,secondaryButtonReceived:ce,paywallTypeReceived:ie,paywallStateReceived:de,textReceived:te,receivedAlreadyActive:Z},internals:{stubs:{expiredProfilePaywallDataStub:F,expiredProfilePaywallDtoStub:j,expiredProfilePaywallWithoutOptionalsDataStub:R,expiredProfilePaywallWithoutOptionalsDtoStub:T},getPaywallQuery:G}},pe={...ue.inputs},me={...ue.outputs},ye={query:ue.internals.getPaywallQuery,stubs:{...ue.internals.stubs}},he=(0,h.G6)({importMetaUrl:"file:///home/jenkins/agent/workspace/selene/client/src/product/premium/services/api_paywall/index.ts",api:{outputs:me,inputs:pe,internals:ye}});var ge=r(55479),ke=r(82672);const{matchPage:be,pages:fe}=ke.$.outputs,xe=be(fe.ProfilePremiumPage),we=({type:e})=>{const{$enabled:t,turnOff:r,turnOn:o}=(0,i.withFactory)({sid:"-janfcr",fn:()=>(0,c.d)(d.qs,!1)}),a=(0,i.createEvent)({sid:"flzo0s"}),h=(0,i.createEvent)({sid:"hkerui"}),g=(0,i.createEvent)({sid:"-m12kjp"}),k=(0,i.createEvent)({sid:"-hc3zf9"}),b=(0,i.createEvent)({sid:"-alg4gz"}),f=(0,i.createEvent)({sid:"wkmnpv"});(0,i.sample)({and:[{clock:o,fn:()=>e,target:he.inputs.requested}],or:{sid:"-8ry16t"}}),(0,i.sample)({and:[{clock:he.outputs.receivedAlreadyActive,target:r}],or:{sid:"-8acm79"}});const x=(0,i.restore)(he.outputs.textReceived,null,{sid:"-wq6pcg"}),w=(0,i.restore)(he.outputs.paymentMethodReceived,null,{sid:"-nzkeoe"}),P=(0,i.restore)(he.outputs.logoReceived,null,{sid:"46ekqg"}),v=(0,i.combine)({and:[P,m.H.outputs.$theme,(e,t)=>n()(e)?null:e[t]],or:{sid:"-rlpa4p"}}),E=(0,i.restore)(he.outputs.primaryButtonReceived,null,{sid:"d1ljcq"}),$=(0,i.restore)(he.outputs.secondaryButtonReceived,null,{sid:"-g4w5n3"}),C=(0,i.sample)({and:[{clock:b,source:E,filter:Boolean,fn:e=>e.action}],or:{sid:"-rnzqqf"}}),S=(0,i.sample)({and:[{clock:f,source:$,filter:Boolean,fn:e=>e.action}],or:{sid:"vhk4t5"}}),M=(0,i.merge)([C,S],{sid:"xkgd86"});(0,i.split)({and:[{source:M,match:e=>e,cases:{pay:s.F.inputs.launch,renew:ge.D.inputs.requested,go_to_profile:a,skip:h}}],or:{sid:"-y4x6ci"}});const _=ge.D.outputs.$isProcessing;return(0,i.sample)({and:[{clock:[ge.D.outputs.subscriptionSuccessfulyRenewed,s.F.outputs.purchaseCompletedSuccessfully],filter:t,target:g}],or:{sid:"-x913xk"}}),(0,i.sample)({and:[{clock:[ge.D.outputs.subscriptionRenewPaymentFailed,ge.D.outputs.requestFailed],filter:t,target:y.G.inputs.showSubscriptionExpiredPayErrorModal}],or:{sid:"-wsja4q"}}),(0,i.sample)({and:[{clock:ge.D.outputs.subscriptionAlreadyActivated,filter:t,target:p.D.inputs.reloadPage}],or:{sid:"-w9ahd3"}}),(0,i.sample)({and:[{clock:k,target:s.F.inputs.launch}],or:{sid:"-vssnk9"}}),(0,i.sample)({and:[{clock:a,source:u.l.outputs.$links.map((e=>e.premiumProfilePage)),filter:(0,i.withFactory)({sid:"-vdckhr",fn:()=>(0,l.f)(xe.$isOpen)}),fn:e=>({pathname:e,type:"reload"}),target:p.D.inputs.navigateTo}],or:{sid:"-vcumcs"}}),(0,i.sample)({and:[{clock:[g,h,a],target:[r,y.G.inputs.hideSubscriptionExpiredPayErrorModal]}],or:{sid:"-ufb65r"}}),{$textData:x,$paymentMethod:w,$logo:v,$primaryButton:E,$secondaryButton:$,$isRenewInProgress:_,paymentMethodClicked:k,primaryButtonClicked:b,secondaryButtonClicked:f,paywallSkiped:h,finishedSuccessfuly:g,$isVisible:t,hidePaywall:r,showPaywall:o,__testable:{goToProfileEvent:a,primaryButtonWithActionClicked:C}}},{$logo:Pe,$paymentMethod:ve,$primaryButton:Ee,$textData:$e,$isRenewInProgress:Ce,paymentMethodClicked:Se,primaryButtonClicked:Me,showPaywall:_e,hidePaywall:Be,$isVisible:De}=we({type:o.Oe.ExpiredTrap}),Ae=(0,i.createEvent)({sid:"-dhh4q0"});(0,i.sample)({and:[{clock:Ae,target:s.F.inputs.launch}],or:{sid:"-s1smpu"}});const je={$isVisible:De,showExpiredTrap:_e,hideExpiredTrap:Be,$logo:Pe,$textData:$e,$paymentMethod:ve,$primaryButton:Ee,$isRenewInProgress:Ce,paymentMethodClicked:Se,primaryButtonClicked:Me,fallbackPrimaryButtonClicked:Ae};var Fe=r(4119),Te=r(23046);const{$logo:Re,$paymentMethod:Ve,$primaryButton:Le,$secondaryButton:qe,$textData:Ne,$isRenewInProgress:Ue,paymentMethodClicked:Oe,primaryButtonClicked:Ie,secondaryButtonClicked:ze,showPaywall:Ge,hidePaywall:Qe,$isVisible:We,finishedSuccessfuly:He}=we({type:Fe.Oe.ExpiredProfile}),Ke=(0,i.createEvent)({sid:"ybhoq0"}),Xe=(0,i.createEvent)({sid:"g29qtv"});(0,i.sample)({and:[{clock:Ke,target:s.F.inputs.launch}],or:{sid:"-hm6eeq"}}),(0,i.sample)({and:[{clock:Xe,target:Qe}],or:{sid:"-hjfffx"}}),(0,i.sample)({and:[{clock:Ge,fn:()=>!0,target:Te.H.inputs.updatePremiumExpiredNoticeShown}],or:{sid:"-h3he8g"}});const Je={$isVisible:We,hideExpiredProfile:Qe,showExpiredProfile:Ge,$logo:Re,$textData:Ne,$paymentMethod:Ve,$primaryButton:Le,$secondaryButton:qe,$isRenewInProgress:Ue,paymentMethodClicked:Oe,primaryButtonClicked:Ie,secondaryButtonClicked:ze,fallbackPrimaryButtonClicked:Ke,fallbackSecondaryButtonClicked:Xe,finishedSuccessfuly:He},{$logo:Ye,$paymentMethod:Ze,$primaryButton:et,$secondaryButton:tt,$textData:rt,$isRenewInProgress:it,paymentMethodClicked:ot,primaryButtonClicked:st,secondaryButtonClicked:at,showPaywall:nt,hidePaywall:lt,$isVisible:ct}=we({type:o.Oe.ExpiredCashback}),dt=(0,i.createEvent)({sid:"-l9bt8d"});(0,i.sample)({and:[{clock:dt,target:s.F.inputs.launch}],or:{sid:"p60klk"}});const ut={$isVisible:ct,hideExpiredCashback:lt,showExpiredCashback:nt,$logo:Ye,$textData:rt,$paymentMethod:Ze,$primaryButton:et,$secondaryButton:tt,$isRenewInProgress:it,paymentMethodClicked:ot,primaryButtonClicked:st,secondaryButtonClicked:at,fallbackPrimaryButtonClicked:dt};var pt=r(82097),mt=r(85349),yt=r(72675),ht=r(54448),gt=r(68621),kt=r(18888),bt=r(96864);const{$isPremiumExpired:ft,$isAnyPremiumActive:xt}=gt.b.outputs,wt={[o.n$.CashbackOffer]:ut.showExpiredCashback,[o.n$.GuidesMapExpiredPremium]:je.showExpiredTrap},Pt=(0,i.createStore)(null,{sid:"-8dns2l"}),vt=(0,i.merge)([ut.hideExpiredCashback,je.hideExpiredTrap],{sid:"l893te"}),Et=(0,i.merge)([s.F.outputs.purchaseCompletedSuccessfully,ge.D.outputs.subscriptionSuccessfulyRenewed],{sid:"-er8r12"});(0,i.sample)({and:[{clock:Et,filter:(0,i.withFactory)({sid:"8yomoj",fn:()=>(0,yt.x)((0,i.withFactory)({sid:"-i4rb0b",fn:()=>(0,ht.or)((0,i.withFactory)({sid:"-i47id8",fn:()=>(0,pt.f)(Pt,o.n$.CashbackOffer)}),(0,i.withFactory)({sid:"-i3nprv",fn:()=>(0,pt.f)(Pt,o.n$.GuidesMapExpiredPremium)}))}))}),target:[kt.U.inputs.requestProfileInfo,bt.W.inputs.fetchUserDataFx]}],or:{sid:"-y0mlon"}});const $t={paywalledScenario:({scenario:e,success:t,failure:r,skip:o})=>{const s=(0,i.createEvent)({sid:"-6yj0cq"}),a=(0,i.createStore)(null,{sid:"-5642vl"}),l=(0,i.withFactory)({sid:"w56xk9",fn:()=>(0,pt.f)(Pt,e)}),c=(0,i.createStore)(!1,{sid:"smbobs"}).on(s,(()=>!0)).reset(t);r&&(0,i.withFactory)({sid:"xlbjh1",fn:()=>(0,mt.m)({clock:r,target:c})});const d=(0,i.withFactory)({sid:"-qt1nye",fn:()=>(0,yt.x)(l,c)});(0,i.sample)({and:[{clock:s,filter:e=>!n()(e),target:a}],or:{sid:"y2wyev"}});const u=(0,i.sample)({and:[{clock:s,source:Pt,filter:ft}],or:{sid:"-9nu9wt"}});return(0,i.sample)({and:[{clock:u,fn:()=>e,target:Pt}],or:{sid:"yllyl5"}}),o&&(0,i.sample)({and:[{clock:s,filter:xt,target:o}],or:{sid:"z1078z"}}),(0,i.sample)({and:[{clock:u,target:wt[e]}],or:{sid:"zgeftd"}}),(0,i.sample)({and:[{clock:Et,source:a,filter:d,fn:e=>{if(!n()(e))return e},target:t}],or:{sid:"-zfrgti"}}),r&&(0,i.sample)({and:[{clock:vt,source:a,filter:d,target:r}],or:{sid:"-yi80kr"}}),s},$currentScenario:Pt};var Ct=r(67294),St=r(4190),Mt=r(47166),_t=r.n(Mt),Bt=r(68243),Dt=r(85893);const At=_t().bind({root:"s__PwMmeuI2weVsjE46sHSI","secondary-button":"s__xhg5mjACPPbxotzJJe9e"}),jt=(0,Ct.memo)((({title:e,description:t,primaryButtonProps:r,secondaryButtonProps:i,paymentBlock:o,logotype:s,customLogo:a,className:l,isLoading:c=!1})=>{const d=(0,Ct.useMemo)((()=>n()(r)?null:{...r,progress:c}),[r,c]),u=(0,Ct.useMemo)((()=>n()(i)?null:{...i,className:At("secondary-button")}),[i]);return(0,Dt.jsxs)(Bt.n,{logo:s,customLogo:a&&(0,Dt.jsx)("img",{src:a,width:"96",height:"96",alt:"paywall logotype"}),title:e,description:t,rootClassname:At("root",l),children:[o&&(0,Dt.jsx)(Bt.n.Payment,{isDisabled:c,onPaymentClick:o.onClick,paymentMethodName:o.paymentMethodName,isPaymentError:o.isPaymentError,customErrorMessage:o.customErrorMessage,customErrorDescription:o.customErrorDescription}),(0,Dt.jsx)(Bt.n.ActionButtons,{primaryButtonProps:d,secondaryButtonProps:u})]})}));jt.displayName="SubscriptionExpired";var Ft=r(28225);const{SubscriptionExpiresDateContainer:Tt}=gt.b.containers,Rt=({onClickPrimaryButton:e})=>{const{t:t}=(0,Ft.useTranslation)("service_premium_paywall");return(0,Dt.jsx)(jt,{logotype:Bt.T.Monogram,title:(0,Dt.jsx)(Ft.Trans,{ns:"service_premium_paywall",i18nKey:"subscriptionExpired.fallbackPaywall.title",components:{date:(0,Dt.jsx)(Tt,{})}}),description:t("subscriptionExpired.fallbackPaywall.description"),primaryButtonProps:{text:t("subscriptionExpired.fallbackPaywall.primaryButton"),onClick:e},isLoading:!1})};var Vt=r(97608),Lt=r(9071),qt=r(5393),Nt=r(6328),Ut=r(99491),Ot=r(33380);const It=_t().bind({root:"s__KOH0J1Roh56z4Bz_tr6N",loader:"s__OaRQ31VpYP9DD3M1H7Ss",background:"s__Xuxbrpjnhpc8XAAGhUF5",content:"s__wECmBk8wnKq6VObBI2AK"}),{SubscriptionExpiredPayErrorContainer:zt}=y.G.containers,Gt=(0,Ct.memo)((({isVisible:e,hideModal:t,fallbackPaywall:r,children:i})=>{const o=(0,St.useUnit)(he.outputs.$state),s=(0,Ct.useMemo)((()=>{switch(o){case"initial":case"pending":return(0,Dt.jsx)(Nt.$,{size:Ut.Ey.L,priority:Ut.Ly.Secondary,className:It("loader")});case"fail":return(0,Dt.jsx)("div",{className:It("content"),children:r});case"done":return(0,Dt.jsx)("div",{className:It("content"),children:i});default:return null}}),[o,i,r]);return(0,Dt.jsxs)(Dt.Fragment,{children:[(0,Dt.jsxs)(Vt.u,{visible:e,onClose:t,className:It("root"),noHeader:!0,children:[(0,Dt.jsx)(Lt.w,{transparent:!0,shadow:!1,children:(0,Dt.jsx)(Lt.w.RightAccessory,{children:(0,Dt.jsx)(qt.P,{onClick:t})})}),s,(0,Dt.jsx)(Ot.E,{theme:"accent",className:It("background")})]}),(0,Dt.jsx)(zt,{})]})}));Gt.displayName="SubscriptionExpiredContainer";const Qt={ExpiredProfileContainer:()=>{const[e,t,r,i,o,s,a,l,c,d,u,p]=(0,St.useUnit)([Je.hideExpiredProfile,Je.$isVisible,Je.$logo,Je.$textData,Je.$paymentMethod,Je.$primaryButton,Je.$secondaryButton,Je.$isRenewInProgress,Je.primaryButtonClicked,Je.secondaryButtonClicked,Je.paymentMethodClicked,Je.fallbackPrimaryButtonClicked]),m=(0,Ct.useMemo)((()=>{if(n()(o))return null;const e=Boolean(o.errorTitle&&o.errorDescription);return{onClick:u,paymentMethodName:o.paymentMethodName,isPaymentError:e,customErrorMessage:o.errorTitle,customErrorDescription:o.errorDescription}}),[o,u]),y=(0,Ct.useMemo)((()=>n()(s)?null:{text:s.text,onClick:c}),[s,c]),h=(0,Ct.useMemo)((()=>n()(a)?null:{text:a.text,onClick:d}),[a,d]);return(0,Dt.jsx)(Gt,{isVisible:t,hideModal:e,fallbackPaywall:(0,Dt.jsx)(Rt,{onClickPrimaryButton:p}),children:(0,Dt.jsx)(jt,{customLogo:r,title:i?.title,description:i?.description,paymentBlock:m,secondaryButtonProps:h,primaryButtonProps:y,isLoading:l})})},ExpiredCashbackOfferContainer:()=>{const[e,t,r,i,o,s,a,l,c,d,u,p]=(0,St.useUnit)([ut.hideExpiredCashback,ut.$isVisible,ut.$logo,ut.$textData,ut.$paymentMethod,ut.$primaryButton,ut.$secondaryButton,ut.$isRenewInProgress,ut.primaryButtonClicked,ut.secondaryButtonClicked,ut.paymentMethodClicked,ut.fallbackPrimaryButtonClicked]),m=(0,Ct.useMemo)((()=>{if(n()(o))return null;const e=Boolean(o.errorTitle&&o.errorDescription);return{onClick:u,paymentMethodName:o.paymentMethodName,isPaymentError:e,customErrorMessage:o.errorTitle,customErrorDescription:o.errorDescription}}),[o,u]),y=(0,Ct.useMemo)((()=>n()(s)?null:{text:s.text,onClick:c}),[s,c]),h=(0,Ct.useMemo)((()=>n()(a)?null:{text:a.text,onClick:d}),[a,d]);return(0,Dt.jsx)(Gt,{isVisible:t,hideModal:e,fallbackPaywall:(0,Dt.jsx)(Rt,{onClickPrimaryButton:p}),children:(0,Dt.jsx)(jt,{customLogo:r,title:i?.title,description:i?.description,paymentBlock:m,secondaryButtonProps:h,primaryButtonProps:y,isLoading:l})})},ExpiredTrapContainer:()=>{const[e,t,r,i,o,s,a,l,c,d]=(0,St.useUnit)([je.hideExpiredTrap,je.$isVisible,je.$logo,je.$textData,je.$paymentMethod,je.$primaryButton,je.$isRenewInProgress,je.primaryButtonClicked,je.paymentMethodClicked,je.fallbackPrimaryButtonClicked]),u=(0,Ct.useMemo)((()=>{if(n()(o))return null;const e=Boolean(o.errorTitle&&o.errorDescription);return{onClick:c,paymentMethodName:o.paymentMethodName,isPaymentError:e,customErrorMessage:o.errorTitle,customErrorDescription:o.errorDescription}}),[o,c]),p=(0,Ct.useMemo)((()=>n()(s)?null:{text:s.text,onClick:l}),[s,l]);return(0,Dt.jsx)(Gt,{isVisible:t,hideModal:e,fallbackPaywall:(0,Dt.jsx)(Rt,{onClickPrimaryButton:d}),children:(0,Dt.jsx)(jt,{customLogo:r,title:i?.title,description:i?.description,paymentBlock:u,primaryButtonProps:p,isLoading:a})})}},Wt={inputs:{showExpiredProfilePaywall:Je.showExpiredProfile,hideExpiredProfilePaywall:Je.hideExpiredProfile,showExpiredCashbackPaywall:ut.showExpiredCashback,hideExpiredCashbackPaywall:ut.hideExpiredCashback,showExpiredTrapPaywall:je.showExpiredTrap,hideExpiredTrapPaywall:je.hideExpiredTrap,paywalledScenario:$t.paywalledScenario},outputs:{expiredProfilePaywallFinishedSuccessfuly:Je.finishedSuccessfuly,$isExpiredProfileOpen:Je.$isVisible},containers:Qt}},70301:function(e,t,r){"use strict";r.d(t,{Q:function(){return u}});var i=r(4190),o=r(28225),s=r(46531),a=r(9071),n=r(5393),l=r(20256),c=r(22837),d=r(85893);const u=()=>{const{t:e}=(0,o.useTranslation)("service_renew_error"),[t,r,u]=(0,i.useUnit)([c.w.$isVisible,c.w.hideSubscriptionExpiredPayError,c.w.tryAnotherCard]);return(0,d.jsxs)(s.G,{visible:t,onClose:r,children:[(0,d.jsx)(s.G.Navigation,{children:(0,d.jsx)(a.w.RightAccessory,{children:(0,d.jsx)(n.P,{onClick:r})})}),(0,d.jsx)(l.M,{onActionButtonClick:u,actionButtonLabel:e("tryAnotherCard"),onCloseButtonClick:r,closeButtonLabel:e("closeButton")})]})}},97741:function(e,t,r){"use strict";r.d(t,{G:function(){return s}});var i=r(70301),o=r(22837);const s={inputs:{showSubscriptionExpiredPayErrorModal:o.w.showSubscriptionExpiredPayError,hideSubscriptionExpiredPayErrorModal:o.w.hideSubscriptionExpiredPayError},containers:{SubscriptionExpiredPayErrorContainer:i.Q}}},22837:function(e,t,r){"use strict";r.d(t,{w:function(){return u}});var i=r(98116),o=r(47047),s=r(2150),a=r(15863);const{$enabled:n,turnOn:l,turnOff:c}=(0,i.withFactory)({sid:"t206s2",fn:()=>(0,o.d)(a.qs,!1)}),d=(0,i.createEvent)({sid:"-i63kxj"});(0,i.sample)({and:[{clock:d,target:[s.F.inputs.launch,c]}],or:{sid:"tlh6kq"}});const u={showSubscriptionExpiredPayError:l,hideSubscriptionExpiredPayError:c,$isVisible:n,tryAnotherCard:d}},66981:function(e,t,r){e.exports=r(25387)}}]);
//# sourceMappingURL=https://private-static.prod.k8s.int.avs.io/selene-source-maps/shared-82c593f4a253ca86324b3481d33cd9edc8c4b127.e99b23d71ee9693a5347.min.js.map